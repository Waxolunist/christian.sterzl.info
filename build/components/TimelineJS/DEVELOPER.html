<h2 id="requirements">Requirements</h2>
<p> python 2.7.x</p>
<p> <a href="http://virtualenvwrapper.readthedocs.org/">virtualenvwrapper</a></p>
<p> <a href="http://nodejs.org">Node.js</a></p>
<p> <a href="http://lesscss.org">LESS</a></p>
<pre><code># npm install -g less
</code></pre><p> <a href="https://github.com/mishoo/UglifyJS">UglifyJS</a></p>
<pre><code># npm install -g uglify-js@1
</code></pre><h2 id="setup">Setup</h2>
<pre><code># Change into the parent directory containing your repositories
cd path_to_repos_root

# Clone the secrets repository (if necessary)
git clone git@github.com:NUKnightLab/secrets.git

# Clone KnightLab support repositories (General public, you can skip this step)
git clone git@github.com:NUKnightLab/cdn.knightlab.com.git
git clone git@github.com:NUKnightLab/fablib.git

# Clone the timeline repository (and the submodules)
git clone --recursive git@github.com:NUKnightLab/TimelineJS.git

# Change into the timeline repository
cd TimelineJS

# Create a virtual environment
mkvirtualenv TimelineJS

# Activate the virtual environment
workon TimelineJS

# Install python requirements
pip install -r requirements.txt

# Run the development server. 
fab serve

# Re-compile to preview changes. Of course this will need to be in another terminal, or after the fab serve command was put in the
# background. It would be great to automate this, but we would like to not add another build system and haven&#39;t figured out how to
# do it with fabric. Pull requests are welcome!
fab build
</code></pre><h2 id="overview">Overview</h2>
<p>Files in the <code>source</code> directory are resources for deployment to the CDN.</p>
<p>Files in the <code>website</code> directory are specific to the website.</p>
<p><code>config.json</code> is used to control building, staging, and deployment</p>
<h2 id="updating-the-documentation-site">Updating the documentation site</h2>
<p>Documentation site files are in the <code>website</code> directory. To review your edits locally, run <code>fab serve</code> to start a local server on <a href="http://localhost:5000">http://localhost:5000</a>. </p>
<h2 id="deploying-updates-to-the-documentation-site-timeline-knightlab-com-">Deploying updates to the documentation site (timeline.knightlab.com)</h2>
<p>To deploy to S3, type <code>fab deploy</code>.</p>
<h2 id="adding-support-for-a-new-language">Adding support for a new language</h2>
<ul>
<li>Add the file with the correct ISO-639 language code name in the <code>source/js/Core/Language/locale</code> directory.</li>
<li>Update website/templates/_make.html to refer to the new file (remember to sort alphabetically by language name, not code)</li>
<li>create a test timeline using the new language to verify that it basically works</li>
<li>deploy a new version (don&#39;t forget to stage_wp)</li>
<li>update knightlab-timeline.php in the TimelineJS-Wordpress-Plugin repo and release that too.</li>
</ul>
<h2 id="deploying-javascript-changes-to-the-cdn">Deploying javascript changes to the CDN</h2>
<p>To stage your changes to a versioned directory in your local CDN repository, type <code>fab stage</code> You will be prompted for the new version number. After you provide it, this <code>fab stage</code> runs a build, copies the files into a versioned directory in your local <code>cdn.knightlab.com</code> repository, and tags the last commit with a version number.</p>
<p>To stage your changes to the <code>latest</code> directory in your local CDN repository, type <code>fab stage_latest</code> You will be prompted for which version number you want to stage as the &#39;latest&#39; version on the CDN. This copies files from the directory with that version in your local <code>cdn.knightlab.com</code> respository into the corresponding <code>latest</code> directory -- so you will have to have used <code>fab stage</code> before this.</p>
<p>You must push and deploy all CDN changes separately from that repository. Don&#39;t forget to edit the index page there until we work out some automated index building system.</p>
