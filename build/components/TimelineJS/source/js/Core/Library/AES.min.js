var Aes={};Aes.cipher=function(r,e){for(var o=4,a=e.length/o-1,n=[[],[],[],[]],t=0;4*o>t;t++)n[t%4][Math.floor(t/4)]=r[t];n=Aes.addRoundKey(n,e,0,o);for(var f=1;a>f;f++)n=Aes.subBytes(n,o),n=Aes.shiftRows(n,o),n=Aes.mixColumns(n,o),n=Aes.addRoundKey(n,e,f,o);n=Aes.subBytes(n,o),n=Aes.shiftRows(n,o),n=Aes.addRoundKey(n,e,a,o);for(var c=new Array(4*o),t=0;4*o>t;t++)c[t]=n[t%4][Math.floor(t/4)];return c},Aes.keyExpansion=function(r){for(var e=4,o=r.length/4,a=o+6,n=new Array(e*(a+1)),t=new Array(4),f=0;o>f;f++){var c=[r[4*f],r[4*f+1],r[4*f+2],r[4*f+3]];n[f]=c}for(var f=o;e*(a+1)>f;f++){n[f]=new Array(4);for(var d=0;4>d;d++)t[d]=n[f-1][d];if(f%o==0){t=Aes.subWord(Aes.rotWord(t));for(var d=0;4>d;d++)t[d]^=Aes.rCon[f/o][d]}else o>6&&f%o==4&&(t=Aes.subWord(t));for(var d=0;4>d;d++)n[f][d]=n[f-o][d]^t[d]}return n},Aes.subBytes=function(r,e){for(var o=0;4>o;o++)for(var a=0;e>a;a++)r[o][a]=Aes.sBox[r[o][a]];return r},Aes.shiftRows=function(r,e){for(var o=new Array(4),a=1;4>a;a++){for(var n=0;4>n;n++)o[n]=r[a][(n+a)%e];for(var n=0;4>n;n++)r[a][n]=o[n]}return r},Aes.mixColumns=function(r){for(var e=0;4>e;e++){for(var o=new Array(4),a=new Array(4),n=0;4>n;n++)o[n]=r[n][e],a[n]=128&r[n][e]?r[n][e]<<1^283:r[n][e]<<1;r[0][e]=a[0]^o[1]^a[1]^o[2]^o[3],r[1][e]=o[0]^a[1]^o[2]^a[2]^o[3],r[2][e]=o[0]^o[1]^a[2]^o[3]^a[3],r[3][e]=o[0]^a[0]^o[1]^o[2]^a[3]}return r},Aes.addRoundKey=function(r,e,o,a){for(var n=0;4>n;n++)for(var t=0;a>t;t++)r[n][t]^=e[4*o+t][n];return r},Aes.subWord=function(r){for(var e=0;4>e;e++)r[e]=Aes.sBox[r[e]];return r},Aes.rotWord=function(r){for(var e=r[0],o=0;3>o;o++)r[o]=r[o+1];return r[3]=e,r},Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],Aes.Ctr={},Aes.Ctr.encrypt=function(r,e,o){var a=16;if(128!=o&&192!=o&&256!=o)return"";r=Utf8.encode(r),e=Utf8.encode(e);for(var n=o/8,t=new Array(n),f=0;n>f;f++)t[f]=isNaN(e.charCodeAt(f))?0:e.charCodeAt(f);var c=Aes.cipher(t,Aes.keyExpansion(t));c=c.concat(c.slice(0,n-16));for(var d=new Array(a),s=(new Date).getTime(),A=s%1e3,i=Math.floor(s/1e3),u=Math.floor(65535*Math.random()),f=0;2>f;f++)d[f]=A>>>8*f&255;for(var f=0;2>f;f++)d[f+2]=u>>>8*f&255;for(var f=0;4>f;f++)d[f+4]=i>>>8*f&255;for(var h="",f=0;8>f;f++)h+=String.fromCharCode(d[f]);for(var v=Aes.keyExpansion(c),C=Math.ceil(r.length/a),y=new Array(C),l=0;C>l;l++){for(var g=0;4>g;g++)d[15-g]=l>>>8*g&255;for(var g=0;4>g;g++)d[15-g-4]=l/4294967296>>>8*g;for(var w=Aes.cipher(d,v),p=C-1>l?a:(r.length-1)%a+1,x=new Array(p),f=0;p>f;f++)x[f]=w[f]^r.charCodeAt(l*a+f),x[f]=String.fromCharCode(x[f]);y[l]=x.join("")}var m=h+y.join("");return m=Base64.encode(m)},Aes.Ctr.decrypt=function(r,e,o){var a=16;if(128!=o&&192!=o&&256!=o)return"";r=Base64.decode(r),e=Utf8.encode(e);for(var n=o/8,t=new Array(n),f=0;n>f;f++)t[f]=isNaN(e.charCodeAt(f))?0:e.charCodeAt(f);var c=Aes.cipher(t,Aes.keyExpansion(t));c=c.concat(c.slice(0,n-16));var d=new Array(8);ctrTxt=r.slice(0,8);for(var f=0;8>f;f++)d[f]=ctrTxt.charCodeAt(f);for(var s=Aes.keyExpansion(c),A=Math.ceil((r.length-8)/a),i=new Array(A),u=0;A>u;u++)i[u]=r.slice(8+u*a,8+u*a+a);r=i;for(var h=new Array(r.length),u=0;A>u;u++){for(var v=0;4>v;v++)d[15-v]=u>>>8*v&255;for(var v=0;4>v;v++)d[15-v-4]=(u+1)/4294967296-1>>>8*v&255;for(var C=Aes.cipher(d,s),y=new Array(r[u].length),f=0;f<r[u].length;f++)y[f]=C[f]^r[u].charCodeAt(f),y[f]=String.fromCharCode(y[f]);h[u]=y.join("")}var l=h.join("");return l=Utf8.decode(l)};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Base64.encode=function(r,e){e="undefined"==typeof e?!1:e;var o,a,n,t,f,c,d,s,A,i,u,h=[],v="",C=Base64.code;if(i=e?r.encodeUTF8():r,A=i.length%3,A>0)for(;A++<3;)v+="=",i+="\x00";for(A=0;A<i.length;A+=3)o=i.charCodeAt(A),a=i.charCodeAt(A+1),n=i.charCodeAt(A+2),t=o<<16|a<<8|n,f=t>>18&63,c=t>>12&63,d=t>>6&63,s=63&t,h[A/3]=C.charAt(f)+C.charAt(c)+C.charAt(d)+C.charAt(s);return u=h.join(""),u=u.slice(0,u.length-v.length)+v},Base64.decode=function(r,e){e="undefined"==typeof e?!1:e;var o,a,n,t,f,c,d,s,A,i,u=[],h=Base64.code;i=e?r.decodeUTF8():r;for(var v=0;v<i.length;v+=4)t=h.indexOf(i.charAt(v)),f=h.indexOf(i.charAt(v+1)),c=h.indexOf(i.charAt(v+2)),d=h.indexOf(i.charAt(v+3)),s=t<<18|f<<12|c<<6|d,o=s>>>16&255,a=s>>>8&255,n=255&s,u[v/4]=String.fromCharCode(o,a,n),64==d&&(u[v/4]=String.fromCharCode(o,a)),64==c&&(u[v/4]=String.fromCharCode(o));return A=u.join(""),e?A.decodeUTF8():A};var Utf8={};Utf8.encode=function(r){var e=r.replace(/[\u0080-\u07ff]/g,function(r){var e=r.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)});return e=e.replace(/[\u0800-\uffff]/g,function(r){var e=r.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},Utf8.decode=function(r){var e=r.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(r){var e=(15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2);return String.fromCharCode(e)});return e=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(r){var e=(31&r.charCodeAt(0))<<6|63&r.charCodeAt(1);return String.fromCharCode(e)})};