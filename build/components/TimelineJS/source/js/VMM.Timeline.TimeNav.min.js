"undefined"!=typeof VMM.Timeline&&"undefined"==typeof VMM.Timeline.TimeNav&&(VMM.Timeline.TimeNav=function(e,t,a){function n(e){P.nav.constraint.left=P.width/2,P.nav.constraint.right=P.nav.constraint.right_min-P.width/2,R.updateConstraint(P.nav.constraint),VMM.Lib.css(x,"left",Math.round(P.width/2)+2),VMM.Lib.css(H,"left",Math.round(P.width/2)-8),c(P.current_slide,P.ease,P.duration,!0,e)}function r(){VMM.fireEvent(X,"UPDATE")}function s(){R.cancelSlide(),P.nav.multiplier.current>P.nav.multiplier.min&&(P.nav.multiplier.current=P.nav.multiplier.current<=1?P.nav.multiplier.current-.25:Math.round(P.nav.multiplier.current>5?P.nav.multiplier.current>16?P.nav.multiplier.current-10:P.nav.multiplier.current-4:P.nav.multiplier.current-1),P.nav.multiplier.current<=0&&(P.nav.multiplier.current=P.nav.multiplier.min),u())}function l(){R.cancelSlide(),P.nav.multiplier.current<P.nav.multiplier.max&&(P.nav.multiplier.current=Math.round(P.nav.multiplier.current>4?P.nav.multiplier.current>16?P.nav.multiplier.current+10:P.nav.multiplier.current+4:P.nav.multiplier.current+1),P.nav.multiplier.current>=P.nav.multiplier.max&&(P.nav.multiplier.current=P.nav.multiplier.max),u())}function o(){R.cancelSlide(),c(0),r()}function d(e){var t=0,a=0;e||(e=window.event),e.originalEvent&&(e=e.originalEvent),"undefined"!=typeof e.wheelDeltaX&&(t=e.wheelDeltaY/6,t=Math.abs(e.wheelDeltaX)>Math.abs(e.wheelDeltaY)?e.wheelDeltaX/6:0),t&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1),a=VMM.Lib.position(A).left+t,a>P.nav.constraint.left?a=P.width/2:a<P.nav.constraint.right&&(a=P.nav.constraint.right),VMM.Lib.css(A,"left",a)}function u(){trace("config.nav.multiplier "+P.nav.multiplier.current),b(!0),V(!0),_(Y,J,!0,!0),_(O,Z,!0),P.nav.constraint.left=P.width/2,P.nav.constraint.right=P.nav.constraint.right_min-P.width/2,R.updateConstraint(P.nav.constraint)}function m(e){R.cancelSlide(),c(e.data.number),r()}function M(e){VMM.Lib.toggleClass(e.data.elem,"zFront")}function c(e,t,a){trace("GO TO MARKER");var n=P.ease,i=P.duration,r=!1,s=!1;et=e,at.left=P.width/2-K[et].pos_left,at.visible.left=Math.abs(at.left)-100,at.visible.right=Math.abs(at.left)+P.width+100,0==et&&(s=!0),et+1==K.length&&(r=!0),null!=t&&""!=t&&(n=t),null!=a&&""!=a&&(i=a);for(var l=0;l<K.length;l++)VMM.Lib.removeClass(K[l].marker,"active");P.start_page&&"start"==K[0].type&&(VMM.Lib.visible(K[0].marker,!1),VMM.Lib.addClass(K[0].marker,"start")),VMM.Lib.addClass(K[et].marker,"active"),VMM.Lib.stop(A),VMM.Lib.animate(A,i,n,{left:at.left})}function h(){var e=0,t=0,a=0,n=[],i=0;for(i=0;i<K.length;i++)if("start"==W[i].type);else{var r=y(rt,K[i].relative_pos),e=t;t=r.begin,a=t-e,n.push(a)}return VMM.Util.average(n).mean}function p(){var e=P.nav.multiplier.current,t=0;for(t=0;e>t;t++)h()<75&&P.nav.multiplier.current>1&&(P.nav.multiplier.current=P.nav.multiplier.current-1)}function v(){var e=g(W[0].startdate),t=g(W[W.length-1].enddate);ot.eon.type="eon",ot.eon.first=e.eons,ot.eon.base=Math.floor(e.eons),ot.eon.last=t.eons,ot.eon.number=B.eons,ot.eon.multiplier=nt.eons,ot.eon.minor=nt.eons,ot.era.type="era",ot.era.first=e.eras,ot.era.base=Math.floor(e.eras),ot.era.last=t.eras,ot.era.number=B.eras,ot.era.multiplier=nt.eras,ot.era.minor=nt.eras,ot.epoch.type="epoch",ot.epoch.first=e.epochs,ot.epoch.base=Math.floor(e.epochs),ot.epoch.last=t.epochs,ot.epoch.number=B.epochs,ot.epoch.multiplier=nt.epochs,ot.epoch.minor=nt.epochs,ot.age.type="age",ot.age.first=e.ages,ot.age.base=Math.floor(e.ages),ot.age.last=t.ages,ot.age.number=B.ages,ot.age.multiplier=nt.ages,ot.age.minor=nt.ages,ot.millenium.type="millenium",ot.millenium.first=e.milleniums,ot.millenium.base=Math.floor(e.milleniums),ot.millenium.last=t.milleniums,ot.millenium.number=B.milleniums,ot.millenium.multiplier=nt.millenium,ot.millenium.minor=nt.millenium,ot.century.type="century",ot.century.first=e.centuries,ot.century.base=Math.floor(e.centuries),ot.century.last=t.centuries,ot.century.number=B.centuries,ot.century.multiplier=nt.century,ot.century.minor=nt.century,ot.decade.type="decade",ot.decade.first=e.decades,ot.decade.base=Math.floor(e.decades),ot.decade.last=t.decades,ot.decade.number=B.decades,ot.decade.multiplier=nt.decade,ot.decade.minor=nt.decade,ot.year.type="year",ot.year.first=e.years,ot.year.base=Math.floor(e.years),ot.year.last=t.years,ot.year.number=B.years,ot.year.multiplier=1,ot.year.minor=nt.month,ot.month.type="month",ot.month.first=e.months,ot.month.base=Math.floor(e.months),ot.month.last=t.months,ot.month.number=B.months,ot.month.multiplier=1,ot.month.minor=Math.round(nt.week),ot.week.type="week",ot.week.first=e.weeks,ot.week.base=Math.floor(e.weeks),ot.week.last=t.weeks,ot.week.number=B.weeks,ot.week.multiplier=1,ot.week.minor=7,ot.day.type="day",ot.day.first=e.days,ot.day.base=Math.floor(e.days),ot.day.last=t.days,ot.day.number=B.days,ot.day.multiplier=1,ot.day.minor=24,ot.hour.type="hour",ot.hour.first=e.hours,ot.hour.base=Math.floor(e.hours),ot.hour.last=t.hours,ot.hour.number=B.hours,ot.hour.multiplier=1,ot.hour.minor=60,ot.minute.type="minute",ot.minute.first=e.minutes,ot.minute.base=Math.floor(e.minutes),ot.minute.last=t.minutes,ot.minute.number=B.minutes,ot.minute.multiplier=1,ot.minute.minor=60,ot.second.type="decade",ot.second.first=e.seconds,ot.second.base=Math.floor(e.seconds),ot.second.last=t.seconds,ot.second.number=B.seconds,ot.second.multiplier=1,ot.second.minor=10}function g(e){var t={};return t.days=e/it.day,t.weeks=t.days/it.week,t.months=t.days/it.month,t.years=t.months/it.year,t.hours=t.days*it.hour,t.minutes=t.days*it.minute,t.seconds=t.days*it.second,t.decades=t.years/it.decade,t.centuries=t.years/it.century,t.milleniums=t.years/it.millenium,t.ages=t.years/it.age,t.epochs=t.years/it.epoch,t.eras=t.years/it.era,t.eons=t.years/it.eon,t}function f(e,t,a){var n,i,r=e.type,s={start:"",end:"",type:r};return n=g(t),s.start=t.months,"eon"==r?s.start=n.eons:"era"==r?s.start=n.eras:"epoch"==r?s.start=n.epochs:"age"==r?s.start=n.ages:"millenium"==r?s.start=t.milleniums:"century"==r?s.start=n.centuries:"decade"==r?s.start=n.decades:"year"==r?s.start=n.years:"month"==r?s.start=n.months:"week"==r?s.start=n.weeks:"day"==r?s.start=n.days:"hour"==r?s.start=n.hours:"minute"==r&&(s.start=n.minutes),"date"==type.of(a)?(i=g(a),s.end=a.months,"eon"==r?s.end=i.eons:"era"==r?s.end=i.eras:"epoch"==r?s.end=i.epochs:"age"==r?s.end=i.ages:"millenium"==r?s.end=a.milleniums:"century"==r?s.end=i.centuries:"decade"==r?s.end=i.decades:"year"==r?s.end=i.years:"month"==r?s.end=i.months:"week"==r?s.end=i.weeks:"day"==r?s.end=i.days:"hour"==r?s.end=i.hours:"minute"==r&&(s.end=i.minutes)):s.end=s.start,s}function y(e,t){return{begin:(t.start-rt.base)*(P.nav.interval_width/P.nav.multiplier.current),end:(t.end-rt.base)*(P.nav.interval_width/P.nav.multiplier.current)}}function b(e){var t=2,a=0,n=-2,i=0,r=150,s=6,l=0,o=P.width,d=[],u=6,m={left:at.visible.left-o,right:at.visible.right+o},M=0,c=0;for(P.nav.minor_width=P.width,VMM.Lib.removeClass(".flag","row1"),VMM.Lib.removeClass(".flag","row2"),VMM.Lib.removeClass(".flag","row3"),M=0;M<K.length;M++){var h,p=K[M],v=y(rt,K[M].relative_pos),g=0,f=!1,b={id:M,pos:0,row:0};if(v.begin=Math.round(v.begin+n),v.end=Math.round(v.end+n),h=Math.round(v.end-v.begin),p.pos_left=v.begin,et==M&&(at.left=P.width/2-v,at.visible.left=Math.abs(at.left),at.visible.right=Math.abs(at.left)+P.width,m.left=at.visible.left-o,m.right=at.visible.right+o),Math.abs(v.begin)>=m.left&&Math.abs(v.begin)<=m.right&&(f=!0),e?(VMM.Lib.stop(p.marker),VMM.Lib.animate(p.marker,P.duration/2,P.ease,{left:v.begin})):(VMM.Lib.stop(p.marker),VMM.Lib.css(p.marker,"left",v.begin)),M==et&&(l=v.begin),h>5&&(VMM.Lib.css(p.lineevent,"height",s),VMM.Lib.css(p.lineevent,"top",r),e?VMM.Lib.animate(p.lineevent,P.duration/2,P.ease,{width:h}):VMM.Lib.css(p.lineevent,"width",h)),Q.length>0){for(c=0;c<Q.length;c++)c<P.nav.rows.current.length&&p.tag==Q[c]&&(t=c,c==P.nav.rows.current.length-1&&(trace("ON LAST ROW"),VMM.Lib.addClass(p.flag,"flag-small-last")));g=P.nav.rows.current[t]}else v.begin-a.begin<P.nav.marker.width+P.spacing?t<P.nav.rows.current.length-1?t++:(t=0,i++):(i=1,t=1),g=P.nav.rows.current[t];a=v,b.pos=v,b.row=t,d.push(b),d.length>u&&VMM.Util.removeRange(d,0),e?(VMM.Lib.stop(p.flag),VMM.Lib.animate(p.flag,P.duration,P.ease,{top:g})):(VMM.Lib.stop(p.flag),VMM.Lib.css(p.flag,"top",g)),P.start_page&&"start"==K[M].type&&VMM.Lib.visible(p.marker,!1),v>P.nav.minor_width&&(P.nav.minor_width=v),v<P.nav.minor_left&&(P.nav.minor_left=v)}e&&(VMM.Lib.stop(A),VMM.Lib.animate(A,P.duration/2,P.ease,{left:P.width/2-l}))}function V(e){var t=0,a=0;for(t=0;t<$.length;t++){var n=$[t],i=y(rt,n.relative_pos),r=0,s=0,l=P.nav.marker.height*P.nav.rows.full.length,o=i.end-i.begin;if(""!=n.tag){for(l=P.nav.marker.height*P.nav.rows.full.length/P.nav.rows.current.length,a=0;a<Q.length;a++)a<P.nav.rows.current.length&&n.tag==Q[a]&&(s=a);r=P.nav.rows.current[s]}else r=-1;e?(VMM.Lib.stop(n.content),VMM.Lib.stop(n.text_content),VMM.Lib.animate(n.content,P.duration/2,P.ease,{top:r,left:i.begin,width:o,height:l}),VMM.Lib.animate(n.text_content,P.duration/2,P.ease,{left:i.begin})):(VMM.Lib.stop(n.content),VMM.Lib.stop(n.text_content),VMM.Lib.css(n.content,"left",i.begin),VMM.Lib.css(n.content,"width",o),VMM.Lib.css(n.content,"height",l),VMM.Lib.css(n.content,"top",r),VMM.Lib.css(n.text_content,"left",i.begin))}}function _(e,t,a,n){var r=0,s=P.width,l={left:at.visible.left-s,right:at.visible.right+s};for(not_too_many=!0,i=0,P.nav.minor_left=0,t.length>100&&(not_too_many=!1,trace("TOO MANY "+t.length)),i=0;i<t.length;i++){var o=t[i].element,d=(t[i].date,t[i].visible),u=y(rt,t[i].relative_pos),m=u.begin,M=t[i].animation,c=!0,h=!1;M.pos=m,M.animate=!1,Math.abs(m)>=l.left&&Math.abs(m)<=l.right&&(h=!0),P.nav.multiplier.current>16&&n?c=!1:65>m-r&&(35>m-r?i%4==0?0==m&&(c=!1):c=!1:VMM.Util.isEven(i)||(c=!1)),c?t[i].is_detached&&(VMM.Lib.append(e,o),t[i].is_detached=!1):(t[i].is_detached=!0,VMM.Lib.detach(o)),d?c?(M.opacity="100",a&&h&&(M.animate=!0)):(M.opacity="0",a&&not_too_many&&(M.animate=!0),t[i].interval_visible=!1):(M.opacity="100",c?(a&&not_too_many?M.animate=!0:a&&h&&(M.animate=!0),t[i].interval_visible=!0):a&&not_too_many&&(M.animate=!0)),r=m,m>P.nav.minor_width&&(P.nav.minor_width=m),m<P.nav.minor_left&&(P.nav.minor_left=m),M.animate?VMM.Lib.animate(o,P.duration/2,P.ease,{opacity:M.opacity,left:M.pos}):(VMM.Lib.css(o,"opacity",M.opacity),VMM.Lib.css(o,"left",m))}P.nav.constraint.right_min=-P.nav.minor_width+P.width,P.nav.constraint.right=P.nav.constraint.right_min+P.width/2,VMM.Lib.css(N,"left",P.nav.minor_left-P.width/2),VMM.Lib.width(N,P.nav.minor_width+P.width+Math.abs(P.nav.minor_left))}function w(e,t,a){var n,i,r=0,s=!0,l=0,o=0,d=Math.ceil(e.number)+2,u={flag:!1,offset:0},m=0;for(VMM.attachElement(a,""),e.date=new Date(W[0].startdate.getFullYear(),0,1,0,0,0),n=e.date.getTimezoneOffset(),m=0;d>m;m++){trace(e.type);var M=!1,c={element:VMM.appendAndGetElement(a,"<div>",e.classname),date:new Date(W[0].startdate.getFullYear(),0,1,0,0,0),visible:!1,date_string:"",type:e.interval_type,relative_pos:0,is_detached:!1,animation:{animate:!1,pos:"",opacity:"100"}};"eon"==e.type?(s&&(i=5e8*Math.floor(W[0].startdate.getFullYear()/5e8)),c.date.setFullYear(i+5e8*r),M=!0):"era"==e.type?(s&&(i=1e8*Math.floor(W[0].startdate.getFullYear()/1e8)),c.date.setFullYear(i+1e8*r),M=!0):"epoch"==e.type?(s&&(i=1e7*Math.floor(W[0].startdate.getFullYear()/1e7)),c.date.setFullYear(i+1e7*r),M=!0):"age"==e.type?(s&&(i=1e6*Math.floor(W[0].startdate.getFullYear()/1e6)),c.date.setFullYear(i+1e6*r),M=!0):"millenium"==e.type?(s&&(i=1e3*Math.floor(W[0].startdate.getFullYear()/1e3)),c.date.setFullYear(i+1e3*r),M=!0):"century"==e.type?(s&&(i=100*Math.floor(W[0].startdate.getFullYear()/100)),c.date.setFullYear(i+100*r),M=!0):"decade"==e.type?(s&&(i=10*Math.floor(W[0].startdate.getFullYear()/10)),c.date.setFullYear(i+10*r),M=!0):"year"==e.type?(s&&(i=W[0].startdate.getFullYear()),c.date.setFullYear(i+r),M=!0):"month"==e.type?(s&&(i=W[0].startdate.getMonth()),c.date.setMonth(i+r)):"week"==e.type?(s&&(i=W[0].startdate.getMonth()),c.date.setMonth(W[0].startdate.getMonth()),c.date.setDate(i+7*r)):"day"==e.type?(s&&(i=W[0].startdate.getDate()),c.date.setMonth(W[0].startdate.getMonth()),c.date.setDate(i+r)):"hour"==e.type?(s&&(i=W[0].startdate.getHours()),c.date.setMonth(W[0].startdate.getMonth()),c.date.setDate(W[0].startdate.getDate()),c.date.setHours(i+r)):"minute"==e.type?(s&&(i=W[0].startdate.getMinutes()),c.date.setMonth(W[0].startdate.getMonth()),c.date.setDate(W[0].startdate.getDate()),c.date.setHours(W[0].startdate.getHours()),c.date.setMinutes(i+r)):"second"==e.type?(s&&(i=W[0].startdate.getSeconds()),c.date.setMonth(W[0].startdate.getMonth()),c.date.setDate(W[0].startdate.getDate()),c.date.setHours(W[0].startdate.getHours()),c.date.setMinutes(W[0].startdate.getMinutes()),c.date.setSeconds(i+r)):"millisecond"==e.type&&(s&&(i=W[0].startdate.getMilliseconds()),c.date.setMonth(W[0].startdate.getMonth()),c.date.setDate(W[0].startdate.getDate()),c.date.setHours(W[0].startdate.getHours()),c.date.setMinutes(W[0].startdate.getMinutes()),c.date.setSeconds(W[0].startdate.getSeconds()),c.date.setMilliseconds(i+r)),"Firefox"==VMM.Browser.browser&&("1970"==c.date.getFullYear()&&c.date.getTimezoneOffset()!=n?(trace("FIREFOX 1970 TIMEZONE OFFSET "+c.date.getTimezoneOffset()+" SHOULD BE "+n),trace(e.type+" "+e.date),u.offset=c.date.getTimezoneOffset()/60,u.flag=!0,c.date.setHours(c.date.getHours()+u.offset)):u.flag&&(u.flag=!1,c.date.setHours(c.date.getHours()+u.offset),M&&(u.flag=!0))),c.date_string=M?c.date.getFullYear()<0?Math.abs(c.date.getFullYear()).toString()+" B.C.":c.date.getFullYear():VMM.Date.prettyDate(c.date,!0),r+=1,s=!1,c.relative_pos=f(rt,c.date),l=c.relative_pos.begin,c.relative_pos.begin>o&&(o=c.relative_pos.begin),VMM.appendElement(c.element,c.date_string),VMM.Lib.css(c.element,"text-indent",-(VMM.Lib.width(c.element)/2)),VMM.Lib.css(c.element,"opacity","0"),t.push(c)}VMM.Lib.width(N,o),_(a,t)}function L(){var e=0,t=0;if(VMM.attachElement(X,""),A=VMM.appendAndGetElement(X,"<div>","timenav"),T=VMM.appendAndGetElement(A,"<div>","content"),G=VMM.appendAndGetElement(A,"<div>","time"),F=VMM.appendAndGetElement(G,"<div>","time-interval-minor"),N=VMM.appendAndGetElement(F,"<div>","minor"),O=VMM.appendAndGetElement(G,"<div>","time-interval-major"),Y=VMM.appendAndGetElement(G,"<div>","time-interval"),S=VMM.appendAndGetElement(X,"<div>","timenav-background"),x=VMM.appendAndGetElement(S,"<div>","timenav-line"),H=VMM.appendAndGetElement(S,"<div>","timenav-indicator"),C=VMM.appendAndGetElement(S,"<div>","timenav-interval-background","<div class='top-highlight'></div>"),U=VMM.appendAndGetElement(X,"<div>","vco-toolbar"),E(),k(),D(),p(),b(!1),V(),_(Y,J,!1,!0),_(O,Z),P.start_page&&($backhome=VMM.appendAndGetElement(U,"<div>","back-home","<div class='icon'></div>"),VMM.bindEvent(".back-home",o,"click"),VMM.Lib.attribute($backhome,"title",VMM.master_config.language.messages.return_to_title),VMM.Lib.attribute($backhome,"rel","timeline-tooltip")),R=new VMM.DragSlider,R.createPanel(X,A,P.nav.constraint,P.touch),P.touch&&P.start_page?(VMM.Lib.addClass(U,"touch"),VMM.Lib.css(U,"top",55),VMM.Lib.css(U,"left",10)):(P.start_page&&VMM.Lib.css(U,"top",27),z=VMM.appendAndGetElement(U,"<div>","zoom-in","<div class='icon'></div>"),I=VMM.appendAndGetElement(U,"<div>","zoom-out","<div class='icon'></div>"),VMM.bindEvent(z,s,"click"),VMM.bindEvent(I,l,"click"),VMM.Lib.attribute(z,"title",VMM.master_config.language.messages.expand_timeline),VMM.Lib.attribute(z,"rel","timeline-tooltip"),VMM.Lib.attribute(I,"title",VMM.master_config.language.messages.contract_timeline),VMM.Lib.attribute(I,"rel","timeline-tooltip"),U.tooltip({selector:"div[rel=timeline-tooltip]",placement:"right"}),VMM.bindEvent(X,d,"DOMMouseScroll"),VMM.bindEvent(X,d,"mousewheel")),0!=P.nav.zoom.adjust)if(P.nav.zoom.adjust<0)for(e=0;e<Math.abs(P.nav.zoom.adjust);e++)l();else for(t=0;t<P.nav.zoom.adjust;t++)s();tt=!0,n(!0),VMM.fireEvent(X,"LOADED")}function E(){var e=0,t=0;for(B=g(W[W.length-1].enddate-W[0].startdate,!0),trace(B),v(),B.centuries>W.length/P.nav.density?(rt=ot.century,st=ot.millenium,lt=ot.decade):B.decades>W.length/P.nav.density?(rt=ot.decade,st=ot.century,lt=ot.year):B.years>W.length/P.nav.density?(rt=ot.year,st=ot.decade,lt=ot.month):B.months>W.length/P.nav.density?(rt=ot.month,st=ot.year,lt=ot.day):B.days>W.length/P.nav.density?(rt=ot.day,st=ot.month,lt=ot.hour):B.hours>W.length/P.nav.density?(rt=ot.hour,st=ot.day,lt=ot.minute):B.minutes>W.length/P.nav.density?(rt=ot.minute,st=ot.hour,lt=ot.second):B.seconds>W.length/P.nav.density?(rt=ot.second,st=ot.minute,lt=ot.second):(trace("NO IDEA WHAT THE TYPE SHOULD BE"),rt=ot.day,st=ot.month,lt=ot.hour),trace("INTERVAL TYPE: "+rt.type),trace("INTERVAL MAJOR TYPE: "+st.type),w(rt,J,Y),w(st,Z,O),e=0;e<J.length;e++)for(t=0;t<Z.length;t++)J[e].date_string==Z[t].date_string&&VMM.attachElement(J[e].element,"")}function k(){var e=0,t=0,a=0;for(K=[],$=[],e=0;e<W.length;e++){var n,i,r,s,l,o,d,u="",c=!1;if(n=VMM.appendAndGetElement(T,"<div>","marker"),i=VMM.appendAndGetElement(n,"<div>","flag"),r=VMM.appendAndGetElement(i,"<div>","flag-content"),s=VMM.appendAndGetElement(n,"<div>","dot"),l=VMM.appendAndGetElement(n,"<div>","line"),o=VMM.appendAndGetElement(l,"<div>","event-line"),_marker_relative_pos=f(rt,W[e].startdate,W[e].enddate),_marker_thumb="",null!=W[e].asset&&""!=W[e].asset?VMM.appendElement(r,VMM.MediaElement.thumbnail(W[e].asset,24,24,W[e].uniqueid)):VMM.appendElement(r,"<div style='margin-right:7px;height:50px;width:2px;float:left;'></div>"),""==W[e].title||" "==W[e].title)if(trace("TITLE NOTHING"),"undefined"!=typeof W[e].slug&&""!=W[e].slug)trace("SLUG"),u=VMM.Util.untagify(W[e].slug),c=!0;else{var h=VMM.MediaType(W[e].asset.media);"quote"==h.type||"unknown"==h.type?(u=VMM.Util.untagify(h.id),c=!0):c=!1}else""!=W[e].title||" "!=W[e].title?(trace(W[e].title),u=VMM.Util.untagify(W[e].title),c=!0):trace("TITLE SLUG NOT FOUND "+W[e].slug);c?VMM.appendElement(r,"<h3>"+u+"</h3>"):(VMM.appendElement(r,"<h3>"+u+"</h3>"),VMM.appendElement(r,"<h3 id='marker_content_"+W[e].uniqueid+"'>"+u+"</h3>")),VMM.Lib.attr(n,"id",("marker_"+W[e].uniqueid).toString()),VMM.bindEvent(i,m,"",{number:e}),VMM.bindEvent(i,M,"mouseenter mouseleave",{number:e,elem:i}),d={marker:n,flag:i,lineevent:o,type:"marker",full:!0,relative_pos:_marker_relative_pos,tag:W[e].tag,pos_left:0},"start"==W[e].type&&(trace("BUILD MARKER HAS START PAGE"),P.start_page=!0,d.type="start"),"storify"==W[e].type&&(d.type="storify"),W[e].tag&&Q.push(W[e].tag),K.push(d)}for(Q=VMM.Util.deDupeArray(Q),P.nav.rows.current=Q.length>3?P.nav.rows.half:P.nav.rows.full,t=0;t<Q.length;t++)if(t<P.nav.rows.current.length){var p=VMM.appendAndGetElement(S,"<div>","timenav-tag");VMM.Lib.addClass(p,"timenav-tag-row-"+(t+1)),Q.length>3?VMM.Lib.addClass(p,"timenav-tag-size-half"):VMM.Lib.addClass(p,"timenav-tag-size-full"),VMM.appendElement(p,"<div><h3>"+Q[t]+"</h3></div>")}if(Q.length>3)for(a=0;a<K.length;a++)VMM.Lib.addClass(K[a].flag,"flag-small"),K[a].full=!1}function D(){var e=6,t=0,a=0;for(a=0;a<j.length;a++){var n={content:VMM.appendAndGetElement(T,"<div>","era"),text_content:VMM.appendAndGetElement(Y,"<div>","era"),startdate:VMM.Date.parse(j[a].startDate),enddate:VMM.Date.parse(j[a].endDate),title:j[a].headline,uniqueid:VMM.Util.unique_ID(6),tag:"",relative_pos:""},i=(VMM.Date.prettyDate(n.startdate),VMM.Date.prettyDate(n.enddate),"<div>&nbsp;</div>");"undefined"!=typeof j[a].tag&&(n.tag=j[a].tag),n.relative_pos=f(rt,n.startdate,n.enddate),VMM.Lib.attr(n.content,"id",n.uniqueid),VMM.Lib.attr(n.text_content,"id",n.uniqueid+"_text"),VMM.Lib.addClass(n.content,"era"+(t+1)),VMM.Lib.addClass(n.text_content,"era"+(t+1)),e>t?t++:t=0,VMM.appendElement(n.content,i),VMM.appendElement(n.text_content,VMM.Util.unlinkify(n.title)),$.push(n)}}trace("VMM.Timeline.TimeNav");var A,T,G,F,Y,O,S,C,x,H,N,U,z,I,R,q,j,P=VMM.Timeline.Config,B={},X=e,W=[],$=[],K=[],J=[],Z=[],Q=[],et=0,tt=!1,at={left:"",visible:{left:"",right:""}},nt={day:24,month:12,year:10,hour:60,minute:60,second:1e3,decade:10,century:100,millenium:1e3,age:1e6,epoch:1e7,era:1e8,eon:5e8,week:4.34812141,days_in_month:30.4368499,days_in_week:7,weeks_in_month:4.34812141,weeks_in_year:52.177457,days_in_year:365.242199,hours_in_day:24},it={day:864e5,week:7,month:30.4166666667,year:12,hour:24,minute:1440,second:86400,decade:10,century:100,millenium:1e3,age:1e6,epoch:1e7,era:1e8,eon:5e8},rt={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"_idd",interval_type:"interval"},st={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"major",interval_type:"interval major"},lt={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"_dd_minor",interval_type:"interval minor"},ot={day:{},month:{},year:{},hour:{},minute:{},second:{},decade:{},century:{},millenium:{},week:{},age:{},epoch:{},era:{},eon:{}};q=P.nav.marker.height/2,P.nav.rows={full:[1,2*q,4*q],half:[1,q,2*q,3*q,4*q,5*q],current:[]},null!=t&&""!=t&&(P.nav.width=t),null!=a&&""!=a&&(P.nav.height=a),this.init=function(e,t){trace("VMM.Timeline.TimeNav init"),"undefined"!=typeof e?this.setData(e,t):trace("WAITING ON DATA")},this.setData=function(e,t){"undefined"!=typeof e?(W={},W=e,j=t,L()):trace("NO DATA")},this.setSize=function(e,t){null!=e&&(P.width=e),null!=t&&(P.height=t),tt&&n()},this.setMarker=function(e,t,a){c(e,t,a)},this.getCurrentNumber=function(){return et}});