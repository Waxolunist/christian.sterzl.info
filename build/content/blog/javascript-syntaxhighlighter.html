<h1 id="syntax-highlighter-for-javascript-prism">Syntax Highlighter for Javascript - Prism</h1>
<p>Have you ever been in need of a syntax highlighter for your homepage?</p>
<p>I wanted to integrate one into my blog today and searched a long time and tried a lot of them.</p>
<p>Finally I found a working one: <a href="http://prismjs.com" target="_blank">Prism</a></p>
<p>Before that I tried following:</p>
<ul>
<li><a href="http://alexgorbatchev.com/wiki/SyntaxHighlighter" target="_blank">SyntaxHighlighter</a></li>
<li><a href="http://code.google.com/p/google-code-prettify/" target="_blank">Google Code Prettify</a></li>
<li><a href="http://softwaremaniacs.org/soft/highlight/en/" target="_blank">Highlight.JS Syntax Highlighter</a></li>
<li><a href="http://startbigthinksmall.wordpress.com/2008/10/30/beautyofcode-jquery-plugin-for-syntax-highlighting/" target="_blank">BeautyOfCode: jQuery Plugin for Syntax Highlighting</a></li>
<li><a href="http://prismjs.com" target="_blank">Prism</a></li>
</ul>
<p>My requirements are:</p>
<ul>
<li>No server side code</li>
<li>No dependencies to frameworks such as MooTools</li>
<li>Manually call the syntax highlighter</li>
<li>No autoload</li>
<li>Manually declaring the programming language</li>
<li>Support for the most common languages</li>
<li>Markup similar to the one markdown generates</li>
<li>Current, active development</li>
<li>Open Source</li>
</ul>
<p>I tried all 5 above, but every of it had its disadvantages, well except prism. </p>
<p><strong>SyntaxHighlighter</strong> uses CommonJS, which I don&#39;t use and it does not support the <code>&lt;pre&gt;&lt;code&gt;</code> notation. It requires to use only the <code>pre</code>-element.</p>
<p><strong>Prettify</strong> didn&#39;t work at all for me. I don&#39;t know what the issue has been but because I didn&#39;t wanted to waste to much time, I didn&#39;t dig into.</p>
<p><strong>Highlight.js</strong> is pretty much straightforward and easy to integrate, but it does always try to detect automatically the language which does sometimes fail. So if I marked the code snippet as javascript like so:</p>
<pre><code class="hljs markup"><span class="hljs-tag">&lt;<span class="hljs-title">pre</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">code</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"language-javascript"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">pre</span>&gt;</span>
</code></pre>
<p>The result after running highlight.js was, no matter in which way I called the api:</p>
<pre><code class="hljs markup"><span class="hljs-tag">&lt;<span class="hljs-title">pre</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">code</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"language-javascript undefined"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">pre</span>&gt;</span>
</code></pre>
<p><strong>BeautyOfCode</strong> is a jquery plugin, not maintained and is based on an old version of SyntaxHighlighter.</p>
<p><strong>Prism</strong> did fulfill all of my requirements. It is easy to use and uses a very appealing syntax in code and markup.</p>
<p>Every syntax highlighter demanded for a different markup and used different hints for detecting the language. So I wrote an angular directive to convert the markup <a href="https://github.com/chjj/marked" target="_blank">marked</a> generates into the markup the syntax highlighter uses. For example marked adds a class <code>lang-html</code> to the code element and prism searches for <code>language-html</code>. </p>
<pre><code class="hljs javascript">.directive(<span class="hljs-string">'highlight'</span>, [<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">return</span> {
    restrict: <span class="hljs-string">'A'</span>,
    priority: -<span class="hljs-number">1</span>,
    link: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postLink</span><span class="hljs-params">(<span class="hljs-variable">$scope</span>, <span class="hljs-variable">$element</span>, <span class="hljs-variable">$attrs</span>)</span> </span>{
      <span class="hljs-comment">// watch the content loaded and apply the</span>
      <span class="hljs-comment">// callback on change</span>
      <span class="hljs-variable">$scope</span>.<span class="hljs-variable">$watch</span>(<span class="hljs-string">"r.content"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(value)</span> </span>{
        <span class="hljs-keyword">var</span> val = value || <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">if</span> (val) {
          <span class="hljs-comment">// search all 'pre code'-pairs and apply prism</span>
          $(<span class="hljs-string">'pre code'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, e)</span> </span>{
            <span class="hljs-keyword">var</span> element = $(e),
              classList = element.attr(<span class="hljs-string">'class'</span>);
            <span class="hljs-keyword">if</span> (_.isString(classList)) {
              classList = classList.split(/\s+/);
              classList = classList.map(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(c)</span> </span>{
                <span class="hljs-comment">// convert lang-* to language-*</span>
                <span class="hljs-keyword">return</span> c.replace(/^lang-/, <span class="hljs-string">'language-'</span>);
              });
              <span class="hljs-keyword">if</span> (classList.length &gt; <span class="hljs-number">0</span>) {
                element.attr(<span class="hljs-string">'class'</span>, classList.join(<span class="hljs-string">' '</span>).trim());
              }
            }
            <span class="hljs-comment">// apply prism to the element</span>
            Prism.highlightElement(e, <span class="hljs-keyword">true</span>);
          });
        }
      });
    }
  };
}])
</code></pre>
<p>This was pretty much all I needed to embed prism, besides loading the library. There is no init method, no method which runs only on <code>document.ready</code>, no dependencies.</p>
<p>I like prism and will recommend it, if someone is in demand of a syntax highlighter, which runs on the client.</p>
